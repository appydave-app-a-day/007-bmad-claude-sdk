# Story 1.3 - Acceptance Test Guide

## Quick Summary

**Story**: Create Basic HTML Client
**Status**: Review
**Test Focus**: Verify basic HTML client served by Express can communicate with server health endpoint

## Prerequisites

**Before testing, ensure:**
- [ ] Story status is "Review" or "Complete"
- [ ] Server is NOT running (you'll start it during tests)
- [ ] Dependencies installed (`npm install` from project root)
- [ ] Working from project root directory

**Environment Setup:**
- Node.js: 18+ (check with `node --version`)
- Port: 3000 (default, configurable via PORT env variable)
- Working directory: `/Users/davidcruwys/dev/ad/appydave-app-a-day/007-bmad-claude-sdk`

---

## üßë Human Tests (Visual/Manual)

Tests requiring human observation - browser, UI, colors, interactive behavior.

### Test 1: AC8 - Page loads successfully at /chat

**What to test**: Page loads successfully in browser at `http://localhost:3000/chat`

**Steps**:
1. Start server: `npm run dev --workspace=@bmad-app/server`
2. Wait for server startup (you'll see blue colored logs)
3. Open browser to: `http://localhost:3000/chat/` (note trailing slash)
4. Observe page renders

**Expected Result**:
‚úÖ HTML page loads showing:
- Page title: "BMAD + Claude SDK - Test Client"
- Blue heading: "Client-Server Communication Test"
- Descriptive text: "This page tests basic HTTP communication..."
- Text input field with placeholder "Enter a message (optional)"
- Blue button labeled "Test Health Endpoint"
- Gray response area with text "Response will appear here..."

**Evidence**:
- Screenshot of browser showing complete page
- URL bar shows `http://localhost:3000/chat/`
- No JavaScript errors in browser console (F12 ‚Üí Console tab)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 2: AC2, AC7 - Form UI with styling

**What to test**: Simple form with text input and submit button, with minimal CSS styling

**Steps**:
1. With server running and page loaded at `http://localhost:3000/chat/`
2. Observe form elements and styling

**Expected Result**:
‚úÖ Form elements styled correctly:
- Text input: Full width, 10px padding, gray border, rounded corners
- Button: Blue background (#2563eb), white text, rounded corners
- Layout: Centered on page, max 600px width
- Font: System fonts (system-ui, -apple-system)
- Response area: Gray background (#f5f5f5), monospace font

‚úÖ Visual details:
- Heading color: Blue (#2563eb)
- Button hover: Darker blue (#1d4ed8)
- Button disabled: Gray (#9ca3af)
- Responsive: Viewport meta tag present

**Evidence**:
- Screenshot showing styled form
- Hover over button to see darker blue
- Check responsive design (resize browser window)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 3: AC9 - Form submission without page reload

**What to test**: Form submission triggers API call and displays result without page reload

**Steps**:
1. With server running and page loaded
2. Optional: Type "test message" in the input field (content doesn't matter)
3. Click "Test Health Endpoint" button
4. Observe button becomes disabled and grayed out
5. Observe "Requesting..." appears in response area
6. Observe final response appears (within 1 second)

**Expected Result**:
‚úÖ Page does NOT reload (no white flash, URL stays same)
‚úÖ Button temporarily disabled during request
‚úÖ Response area shows:
```
Server response:
{
  "status": "ok"
}
```
‚úÖ Response displayed in monospace font
‚úÖ No page refresh, no navigation away

**Evidence**:
- Video/GIF showing button click ‚Üí disabled state ‚Üí response (no reload)
- Screenshot of final response displayed
- Browser console shows no errors (F12 ‚Üí Console)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 4: AC3, AC4 - Fetch request and response display

**What to test**: Client-side JavaScript makes fetch request to `/api/health` and displays response

**Steps**:
1. With server running and page loaded
2. Open browser DevTools (F12)
3. Go to Network tab
4. Click "Test Health Endpoint" button
5. Observe Network tab shows request to `/api/health`
6. Observe response displayed on page

**Expected Result**:
‚úÖ Network tab shows:
- Request URL: `http://localhost:3000/api/health`
- Request Method: GET
- Status: 200 OK
- Response: `{"status":"ok"}`

‚úÖ Page displays:
- Response text: `Server response:\n{\n  "status": "ok"\n}`
- Formatted JSON (indented, readable)

**Evidence**:
- Screenshot of Network tab showing successful fetch
- Screenshot of page showing formatted response

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 5: Error handling (bonus visual test)

**What to test**: Error handling when server is unavailable

**Steps**:
1. Stop the server (Ctrl+C in terminal)
2. In browser, click "Test Health Endpoint" button again
3. Observe error message displayed

**Expected Result**:
‚úÖ Error message appears in response area:
```
Error: Failed to fetch

Make sure the server is running on port 3000.
```
‚úÖ User-friendly error message (not technical stack trace)
‚úÖ Button re-enabled after error

**Evidence**:
- Screenshot showing error message
- Helpful guidance message present

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

## ü§ñ Terminal Tests (Scriptable)

Tests using command-line tools - copy-paste ready commands.

### Test A: AC1 - index.html file exists

**What to test**: `packages/client` workspace contains basic HTML structure (`index.html`)

**Command**:
```bash
ls -la packages/client/index.html
```

**Expected Output**:
```
-rw-r--r--  1 user  staff  {size} {date} packages/client/index.html
```

**Validation**:
- ‚úÖ File exists at exact path `packages/client/index.html`
- ‚úÖ File is readable (not zero bytes)
- ‚úÖ No permission errors

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test B: AC10 - /public directory created

**What to test**: Create `/public` directory at project root with `.gitkeep`

**Command**:
```bash
ls -la public/
```

**Expected Output**:
```
total 0
drwxr-xr-x   3 user  staff   96 {date} .
drwxr-xr-x  16 user  staff  512 {date} ..
-rw-r--r--   1 user  staff    0 {date} .gitkeep
```

**Validation**:
- ‚úÖ Directory `public/` exists at project root
- ‚úÖ Contains `.gitkeep` file (keeps directory in git)
- ‚úÖ Directory is writable (for future Epic 2 generated HTML)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test C: AC5 - Express static file serving configured

**What to test**: Express server configured to serve static files from `packages/client`

**Command**:
```bash
grep -A 2 "express.static" packages/server/src/server.ts
```

**Expected Output**:
```typescript
const clientPath = path.join(__dirname, '../../client');
app.use('/chat', express.static(clientPath));
logger.info('Static files served from packages/client for /chat route');
```

**Validation**:
- ‚úÖ `express.static(clientPath)` middleware configured
- ‚úÖ Mounted on `/chat` route
- ‚úÖ Client path resolves to `../../client` from `dist/` directory
- ‚úÖ Logger info call documents static file serving

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test D: AC6 - /chat route serves HTML client

**What to test**: Route `/chat` serves the HTML client (via curl)

**Command**:
```bash
# Start server first: npm run dev --workspace=@bmad-app/server
curl -s http://localhost:3000/chat/ | head -10
```

**Expected Output**:
```html
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>BMAD + Claude SDK - Test Client</title>
  <style>
    /* Minimal CSS for readability */
    body {
      font-family: system-ui, -apple-system, sans-serif;
```

**Validation**:
- ‚úÖ HTML content returned (DOCTYPE declaration)
- ‚úÖ Title matches "BMAD + Claude SDK - Test Client"
- ‚úÖ Includes CSS styling
- ‚úÖ No 404 or error responses

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test E: Server startup logs (visual terminal test)

**What to test**: Server logs include /chat route information

**Command**:
```bash
npm run dev --workspace=@bmad-app/server
```

**Expected Output** (in terminal):
```
[{timestamp}] [Server] Static files served from packages/client for /chat route
[{timestamp}] [Server] Server started on port 3000
[{timestamp}] [Server] Health check: http://localhost:3000/api/health
[{timestamp}] [Server] Test client: http://localhost:3000/chat
```

**Validation**:
- ‚úÖ All log messages appear in blue color (ANSI codes)
- ‚úÖ Timestamp in ISO 8601 format
- ‚úÖ Component prefix `[Server]` present
- ‚úÖ Test client URL logged: `http://localhost:3000/chat`

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

## ‚è≥ Not Testable Yet

*No acceptance criteria deferred to future stories.*

All 10 acceptance criteria are testable in this story.

---

## Test Checklist

Copy this checklist to track overall progress:

**Human Tests:**
- [ ] Test 1: Page loads at /chat
- [ ] Test 2: Form UI with styling
- [ ] Test 3: Form submission without reload
- [ ] Test 4: Fetch request and response display
- [ ] Test 5: Error handling (bonus)

**Terminal Tests:**
- [ ] Test A: index.html exists
- [ ] Test B: /public directory created
- [ ] Test C: Express static configured
- [ ] Test D: /chat route serves HTML
- [ ] Test E: Server startup logs

**Overall Status**: ‚¨ú Not Started | üîÑ In Progress | ‚úÖ All Passed | ‚ùå Issues Found

---

## Troubleshooting

### Issue: Port 3000 already in use
**Symptom**: Server fails to start with `EADDRINUSE` error
**Solution**:
1. Find process: `lsof -i :3000`
2. Kill it: `kill -9 {PID}`
3. Or use different port: `PORT=3001 npm run dev --workspace=@bmad-app/server`

### Issue: Page redirects from /chat to /chat/
**Symptom**: URL changes from `/chat` to `/chat/` automatically
**Solution**: This is expected Express.static behavior. Both URLs work correctly. Use `/chat/` directly to avoid redirect.

### Issue: TypeScript build fails
**Symptom**: `npm run build` shows compilation errors
**Solution**:
1. Run `npm install` from project root
2. Check TypeScript version: `npx tsc --version` (should be 5.7+)
3. Verify no syntax errors in server.ts

### Issue: Browser shows "Cannot GET /chat"
**Symptom**: 404 error when accessing /chat
**Solution**:
1. Ensure server is running (check terminal)
2. Try with trailing slash: `http://localhost:3000/chat/`
3. Verify static middleware is configured (Test C)

### Issue: Form submission causes full page reload
**Symptom**: Page flashes white, URL stays /chat but page reloads
**Solution**:
1. Check browser console for JavaScript errors
2. Verify `e.preventDefault()` is called in submit handler
3. Check that `<script>` tag is present in HTML (line 84+)

### Issue: No colored logs in terminal
**Symptom**: Server logs appear without colors
**Solution**:
1. Check terminal supports ANSI colors (most modern terminals do)
2. Verify logger utility uses ANSI escape codes
3. Try different terminal (iTerm2, VS Code integrated terminal)

---

## Test Results Summary

**Date Tested**: _________________
**Tester**: _________________

**Results**:
- Human Tests: __ / 5 passed
- Terminal Tests: __ / 5 passed
- Total: __ / 10 passed

**Issues Found**:
1. ______________________________________________________
2. ______________________________________________________
3. ______________________________________________________

**Sign-off**: ‚¨ú Story accepted | ‚ùå Issues require fixes

**Notes**:
_______________________________________________________________
_______________________________________________________________
_______________________________________________________________

---

*Generated by Taylor (SAT Guide Creator) from Story 1.3*
