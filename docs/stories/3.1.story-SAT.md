# Story 3.1 - Acceptance Test Guide

## Quick Summary

**Story**: Initialize React + Vite Application
**Status**: Review
**Test Focus**: Verify React 19 + Vite 7 application scaffolded successfully with TypeScript, HMR, dual-mode development workflow, and Express integration

## Prerequisites

**Before testing, ensure:**
- [ ] Story status is "Review"
- [ ] Server is NOT running on port 3000
- [ ] Vite dev server is NOT running on port 5173
- [ ] Dependencies installed (`npm install` from project root)
- [ ] Terminal supports colored output for concurrently test

**Environment Setup:**
- Node.js: 18+ (verify with `node --version`)
- Port 3000: Express server
- Port 5173: Vite dev server
- Working directory: `/Users/davidcruwys/dev/ad/appydave-app-a-day/007-bmad-claude-sdk`

---

## ü§ñ Terminal Tests (Scriptable)

Tests using command-line tools - copy-paste ready commands.

### Test A: AC1 - React + Vite workspace configuration

**What to test**: Verify packages/client is configured as React 19 + Vite 7 workspace with correct dependencies

**Command**:
```bash
cat packages/client/package.json | grep -E '"(name|react|vite)"'
```

**Expected Output**:
```
  "name": "@bmad-app/client",
    "react": "^19.2.0",
    "react-dom": "^19.2.0",
    "vite": "^7.2.2"
```

**Validation**:
- ‚úÖ Package name is `@bmad-app/client`
- ‚úÖ React version is 19.x
- ‚úÖ React-dom version is 19.x
- ‚úÖ Vite version is 7.x

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. All validation criteria met.

---

### Test B: AC2 - TypeScript configuration with React JSX support

**What to test**: Verify TypeScript is configured with React JSX transform

**Command**:
```bash
cat packages/client/tsconfig.app.json | grep -E '"jsx"'
```

**Expected Output**:
```
    "jsx": "react-jsx",
```

**Validation**:
- ‚úÖ JSX transform is set to `react-jsx` (modern React 17+ transform)
- ‚úÖ File exists and is valid JSON

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. JSX configuration verified.

---

### Test C: AC3 - Vite dev server port configuration

**What to test**: Verify Vite server is configured to run on port 5173

**Command**:
```bash
cat packages/client/vite.config.ts | grep -E 'port'
```

**Expected Output**:
```
    port: 5173
```

**Validation**:
- ‚úÖ Server port explicitly set to 5173
- ‚úÖ Configuration file uses TypeScript (vite.config.ts)

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. Port 5173 configured correctly.

---

### Test D: AC5 - Build script compiles to dist/

**What to test**: Verify production build creates dist/ directory with bundled files

**Command**:
```bash
# Clean previous build
rm -rf packages/client/dist

# Build client
npm run build --workspace=@bmad-app/client

# List build output
ls -la packages/client/dist/
```

**Expected Output**:
```
total [size]
drwxr-xr-x  [details] .
drwxr-xr-x  [details] ..
-rw-r--r--  [details] index.html
drwxr-xr-x  [details] assets
```

**Validation**:
- ‚úÖ `dist/` directory created
- ‚úÖ `index.html` exists in dist/
- ‚úÖ `assets/` directory exists (contains bundled JS/CSS)
- ‚úÖ No TypeScript compilation errors in output

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. Build output: 29 modules transformed, built in 565ms. Note: No separate `/chat` subdirectory - assets are in `/assets` with base path configured in vite.config.ts.

---

### Test E: AC7 - Concurrent dev script configuration

**What to test**: Verify root package.json has concurrent dev script with colored prefixes

**Command**:
```bash
cat package.json | grep -A2 '"dev"'
```

**Expected Output**:
```
    "dev": "concurrently --names \"SERVER,CLIENT\" --prefix-colors \"blue,green\" \"npm:dev:server\" \"npm:dev:client\"",
    "dev:server": "npm run dev --workspace=@bmad-app/server",
    "dev:client": "npm run dev --workspace=@bmad-app/client",
```

**Validation**:
- ‚úÖ Uses `concurrently` package
- ‚úÖ Names configured as "SERVER,CLIENT"
- ‚úÖ Colors configured as "blue,green"
- ‚úÖ Runs both workspaces in parallel

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. Concurrent script configured correctly with named prefixes and colors.

---

### Test F: AC6 - Express route serving React build

**What to test**: Verify Express server has /chat route configured to serve React build

**Command**:
```bash
cat packages/server/src/server.ts | grep -A5 "Static file serving for /chat"
```

**Expected Output**:
```
// Static file serving for /chat route (Story 3.1)
// Priority 1: /chat always serves React app from packages/client/dist
//
// Development mode: Vite dev server runs on port 5173 with HMR
// - Access React app at http://localhost:5173 for fast iteration with Hot Module Replacement
// - Vite dev server serves source files directly from packages/client/src
```

**Validation**:
- ‚úÖ Comment explains dual-mode workflow
- ‚úÖ Route uses `express.static()` middleware
- ‚úÖ Path resolves to `packages/client/dist`

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. Express route configured with comprehensive dual-mode comments.

---

### Test G: AC5 - TypeScript compilation without errors

**What to test**: Verify TypeScript compiles successfully without errors or warnings

**Command**:
```bash
npm run build --workspace=@bmad-app/client 2>&1 | tail -5
```

**Expected Output**:
```
vite v7.x.x building for production...
‚úì [number] modules transformed.
dist/index.html                   [size] kB
dist/chat/assets/index-[hash].css [size] kB ‚îÇ gzip: [size] kB
dist/chat/assets/index-[hash].js  [size] kB ‚îÇ gzip: [size] kB
‚úì built in [time]ms
```

**Validation**:
- ‚úÖ No TypeScript errors
- ‚úÖ No warnings in output
- ‚úÖ Build completes successfully
- ‚úÖ Output shows bundled files with size information

**Status**: ‚úÖ Passed

**Notes**: Automated test executed successfully. Clean TypeScript compilation with no errors. Build completed in 565ms with 29 modules transformed.

---

## üßë Human Tests (Visual/Manual)

Tests requiring human observation - browser, UI, colors, interactive behavior.

### Test 1: AC8 - Basic React app renders "Hello World"

**What to test**: Verify React application renders correctly in browser at Vite dev server URL

**Steps**:
1. Start Vite dev server: `npm run dev --workspace=@bmad-app/client`
2. Wait for terminal to show "Local: http://localhost:5173/"
3. Open browser to `http://localhost:5173`
4. Observe page content

**Expected Result**:
‚úÖ Browser displays React application:
- Heading displays "Hello World"
- Subheading displays "BMAD + Claude SDK Chat Interface"
- Text uses system font (system-ui)
- Page has padding (2rem)

**Evidence**:
- Browser screenshot showing "Hello World" heading
- URL bar shows `http://localhost:5173`

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 2: AC4 - Hot Module Replacement (HMR) working

**What to test**: Verify Vite HMR updates page without full reload when editing React components

**Steps**:
1. Keep Vite dev server running from Test 1
2. Keep browser tab open to `http://localhost:5173`
3. Open `packages/client/src/App.tsx` in editor
4. Change heading text from "Hello World" to "HMR Test"
5. Save file
6. Observe browser tab (do NOT refresh manually)

**Expected Result**:
‚úÖ Page updates automatically without full reload:
- Heading changes to "HMR Test"
- No browser refresh (no white flash)
- Terminal shows "hmr update" message
- Page state preserved (if any)

**Evidence**:
- Browser shows updated content instantly
- Terminal logs: `[vite] hmr update /src/App.tsx`

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 3: AC10 - No console errors or warnings (Development)

**What to test**: Verify browser console shows no errors or warnings in Vite dev mode

**Steps**:
1. Keep Vite dev server running
2. Open browser to `http://localhost:5173`
3. Open browser DevTools (F12 or right-click ‚Üí Inspect)
4. Navigate to Console tab
5. Observe console output

**Expected Result**:
‚úÖ Console is clean:
- No red error messages
- No yellow warning messages
- Only informational messages (if any)
- All network requests return 200 status

**Evidence**:
- Console screenshot showing no errors
- Network tab shows all resources loaded successfully

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 4: AC9 - Development mode uses Vite dev server

**What to test**: Verify development workflow uses Vite dev server on port 5173

**Steps**:
1. Stop all running servers (Ctrl+C if running)
2. Start concurrent dev script: `npm run dev` from project root
3. Wait for both servers to start
4. Observe terminal output for SERVER (blue) and CLIENT (green) prefixes
5. Open browser to `http://localhost:5173`
6. Verify HMR works (edit App.tsx, see instant update)

**Expected Result**:
‚úÖ Development mode configured correctly:
- Terminal shows SERVER logs in blue
- Terminal shows CLIENT logs in green
- Vite dev server runs on port 5173
- HMR updates work (instant component refresh)
- React app accessible at `http://localhost:5173`

**Evidence**:
- Terminal screenshot showing colored output
- Browser at `http://localhost:5173` renders React app
- HMR test successful (edit component, see update)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 5: AC7 - Concurrent script shows colored output

**What to test**: Verify concurrently displays colored prefixes for server and client logs

**Steps**:
1. Stop all running servers
2. Run `npm run dev` from project root
3. Observe terminal output carefully

**Expected Result**:
‚úÖ Terminal shows colored process output:
- Server logs prefixed with `[SERVER]` in blue color
- Client logs prefixed with `[CLIENT]` in green color
- Both processes start successfully
- Logs clearly separated by color

**Evidence**:
- Terminal screenshot showing blue and green colored prefixes
- Example SERVER log: `[SERVER] Server started on port 3000` (blue)
- Example CLIENT log: `[CLIENT] Local: http://localhost:5173/` (green)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 6: AC9 - Production mode serves compiled bundle via Express

**What to test**: Verify Express serves compiled React bundle from /chat route in production mode

**Steps**:
1. Stop all running servers
2. Build client production bundle: `npm run build --workspace=@bmad-app/client`
3. Start ONLY Express server: `npm run dev --workspace=@bmad-app/server`
4. Open browser to `http://localhost:3000/chat`
5. Open browser DevTools ‚Üí Network tab
6. Observe source of files (should be Express, not Vite)

**Expected Result**:
‚úÖ Production mode serves compiled bundle:
- React app renders at `http://localhost:3000/chat`
- Network tab shows files served from Express (port 3000)
- No Vite dev server running (port 5173 not accessible)
- Files are bundled/minified (check source in DevTools)
- No HMR (expected - production build)

**Evidence**:
- Browser screenshot showing app at `http://localhost:3000/chat`
- Network tab showing requests to `localhost:3000` (not 5173)
- Source files are minified bundles (not original source)

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 7: AC6 - Express /chat route verification

**What to test**: Verify Express serves React app from /chat route (trailing slash handled)

**Steps**:
1. Keep production mode running (Express only, from Test 6)
2. Test different URL variations:
   - Open `http://localhost:3000/chat` (no trailing slash)
   - Open `http://localhost:3000/chat/` (with trailing slash)
3. Observe both URLs render the same React app

**Expected Result**:
‚úÖ Express route configured correctly:
- `/chat` redirects to `/chat/` and serves React app
- `/chat/` serves index.html from dist/
- Both URLs show identical React app
- No 404 errors

**Evidence**:
- Both URLs render "Hello World" React app
- Network tab shows index.html served from /chat/

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 8: AC10 - No console errors (Production)

**What to test**: Verify browser console shows no errors when accessing production build via Express

**Steps**:
1. Keep Express server running (production mode)
2. Open browser to `http://localhost:3000/chat`
3. Open browser DevTools ‚Üí Console tab
4. Refresh page (Ctrl+R or Cmd+R)
5. Observe console output

**Expected Result**:
‚úÖ Console is clean in production mode:
- No red error messages
- No yellow warning messages
- All assets load successfully (check Network tab)
- No 404 errors for missing resources

**Evidence**:
- Console screenshot showing no errors
- Network tab shows all resources return 200 status

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 9: AC9 - Dual-mode workflow comparison

**What to test**: Verify understanding of when to use development vs production mode

**Steps**:
1. Review dual-mode workflow understanding:
   - **Development**: `npm run dev` ‚Üí Vite on 5173 (HMR, fast iteration)
   - **Production**: Build + server ‚Üí Express on 3000/chat (realistic deployment)
2. Test switching between modes:
   - Stop all servers
   - Run `npm run dev` (both servers) ‚Üí Access `http://localhost:5173`
   - Stop all servers
   - Build client ‚Üí Run server only ‚Üí Access `http://localhost:3000/chat`

**Expected Result**:
‚úÖ Dual-mode workflow clear:
- Development mode: Fast HMR on port 5173 for component iteration
- Production mode: Realistic serving from Express for integration testing
- Both modes render same "Hello World" app
- Clear separation of concerns (Vite for dev, Express for prod)

**Evidence**:
- Successful switching between modes
- Understanding of when to use each mode
- Both modes verified working

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

### Test 10: AC1/AC2 - Verify workspace integration

**What to test**: Verify client package is properly integrated as NPM workspace

**Steps**:
1. Run workspace-specific commands from root directory:
   ```bash
   npm run dev --workspace=@bmad-app/client
   npm run build --workspace=@bmad-app/client
   ```
2. Verify commands execute successfully
3. Check that workspace dependency on `@bmad-app/shared` resolves

**Expected Result**:
‚úÖ Workspace integration complete:
- Workspace scripts execute from root directory
- Package name `@bmad-app/client` recognized
- Shared package dependency resolves (even if not used yet)
- NPM workspace structure functioning

**Evidence**:
- Commands execute without "workspace not found" errors
- Build completes successfully
- Terminal shows workspace-specific output

**Status**: ‚¨ú Not Tested | ‚úÖ Passed | ‚ùå Failed

**Notes**: _________________

---

## Test Checklist

Copy this checklist to track overall progress:

**Terminal Tests (Automated):**
- [x] Test A: React + Vite workspace configuration ‚úÖ
- [x] Test B: TypeScript configuration with React JSX ‚úÖ
- [x] Test C: Vite dev server port configuration ‚úÖ
- [x] Test D: Build script compiles to dist/ ‚úÖ
- [x] Test E: Concurrent dev script configuration ‚úÖ
- [x] Test F: Express route serving React build ‚úÖ
- [x] Test G: TypeScript compilation without errors ‚úÖ

**Human Tests (Manual):**
- [ ] Test 1: Basic React app renders "Hello World"
- [ ] Test 2: Hot Module Replacement (HMR) working
- [ ] Test 3: No console errors (Development)
- [ ] Test 4: Development mode uses Vite dev server
- [ ] Test 5: Concurrent script shows colored output
- [ ] Test 6: Production mode serves compiled bundle
- [ ] Test 7: Express /chat route verification
- [ ] Test 8: No console errors (Production)
- [ ] Test 9: Dual-mode workflow comparison
- [ ] Test 10: Workspace integration verification

**Overall Status**: ‚¨ú Not Started | üîÑ In Progress | ‚úÖ All Passed | ‚ùå Issues Found

---

## Troubleshooting

### Issue: Port 5173 already in use
**Symptom**: `Error: listen EADDRINUSE: address already in use :::5173`
**Solution**:
- Kill existing Vite process: `lsof -ti:5173 | xargs kill -9`
- Or change port in `vite.config.ts` temporarily

### Issue: Port 3000 already in use
**Symptom**: `Error: listen EADDRINUSE: address already in use :::3000`
**Solution**:
- Kill existing Express process: `lsof -ti:3000 | xargs kill -9`
- Or change PORT environment variable: `PORT=3001 npm run dev --workspace=@bmad-app/server`

### Issue: TypeScript compilation errors
**Symptom**: Build fails with TypeScript errors
**Solution**:
- Verify TypeScript version: `npm list typescript`
- Check `tsconfig.json` and `tsconfig.app.json` configuration
- Ensure all dependencies installed: `npm install`

### Issue: React app shows blank page
**Symptom**: Browser shows white screen, no content
**Solution**:
- Check browser console for errors (F12 ‚Üí Console tab)
- Verify `packages/client/src/main.tsx` renders `<App />` component
- Check `index.html` has `<div id="root"></div>` element
- Rebuild client: `npm run build --workspace=@bmad-app/client`

### Issue: HMR not working
**Symptom**: Changes to App.tsx don't reflect in browser
**Solution**:
- Ensure using Vite dev server (port 5173, not Express)
- Check terminal for HMR error messages
- Hard refresh browser: Ctrl+Shift+R (Windows/Linux) or Cmd+Shift+R (Mac)
- Restart Vite dev server

### Issue: Express /chat returns 404
**Symptom**: `http://localhost:3000/chat` shows "Not found" error
**Solution**:
- Verify client build exists: `ls packages/client/dist/index.html`
- Build client first: `npm run build --workspace=@bmad-app/client`
- Check Express route configuration in `packages/server/src/server.ts`
- Verify path resolution: `__dirname` should resolve to `packages/server/dist`

### Issue: Colored output not showing in concurrently
**Symptom**: Terminal shows `[SERVER]` and `[CLIENT]` without colors
**Solution**:
- Some terminals don't support ANSI colors (e.g., basic Windows CMD)
- Try using a different terminal (Windows Terminal, iTerm2, etc.)
- Verify `concurrently` installed: `npm list concurrently`
- Colors work in most modern terminals (macOS Terminal, Linux terminals)

### Issue: Assets not loading from /chat/assets
**Symptom**: Browser shows 404 for CSS/JS files
**Solution**:
- Verify `vite.config.ts` has `base: '/chat/'` configured
- Rebuild client after config change: `npm run build --workspace=@bmad-app/client`
- Check browser Network tab for actual request URLs
- Ensure Express static middleware configured correctly

---

## Test Results Summary

**Date Tested**: 2025-11-16
**Tester**: Taylor (SAT Guide Creator - Automated Tests)

**Automated Test Results**:
- Terminal Tests: 7 / 7 passed ‚úÖ
- Human Tests: 0 / 10 passed (pending manual execution)
- Total: 7 / 17 passed

**Automated Test Details**:
1. ‚úÖ Test A: React 19.2.0 + Vite 7.2.2 workspace verified
2. ‚úÖ Test B: TypeScript JSX transform configured correctly
3. ‚úÖ Test C: Vite server port 5173 configured
4. ‚úÖ Test D: Build output created successfully (29 modules, 565ms)
5. ‚úÖ Test E: Concurrent script with colored prefixes verified
6. ‚úÖ Test F: Express /chat route configuration verified
7. ‚úÖ Test G: TypeScript compilation clean, no errors

**Issues Found**:
None - All automated tests passed successfully.

**Next Steps**:
- Manual execution of Human Tests 1-10 required (browser-based tests)
- User should execute Human Tests and update this file with results
- Focus on: HMR verification, console error checks, dual-mode workflow testing

**Sign-off**: üîÑ Automated tests passed - Awaiting human test execution

---

*Generated by Taylor (SAT Guide Creator) from Story 3.1*
